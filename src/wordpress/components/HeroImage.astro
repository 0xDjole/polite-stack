---
// src/lib/wordpress/components/ACFImage.astro
import { getImage } from '../api.js';
import { config } from '../index.js';

export interface Props {
  postId: number;
  fieldName: string;
  alt?: string;
  className?: string;
  style?: string;
  fallbackImage?: string;
  endpoint?: string;
}

const {
  postId,
  fieldName,
  alt = '',
  className = '',
  style = '',
  fallbackImage = '/images/fallback.jpg',
  endpoint = config.endpoint,
} = Astro.props;

console.log('enddd', endpoint, config);

// Use endpoint from props or global config
const imageData = await getImage(endpoint, postId, fieldName);
const imageUrl = imageData || fallbackImage;
const imageAlt = alt || 'Image';
---

<div class={`acf-image-container ${className}`} style={style}>
  {imageUrl && <img src={imageUrl} alt={imageAlt} class="acf-image" />}
  <slot />
</div>
<style>
  .acf-image-container {
    position: relative;
    width: 100%;
    overflow: hidden;
  }
  .acf-image {
    width: 100%;
    height: auto;
    display: block;
  }
</style>
